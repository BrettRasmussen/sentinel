#*raw
#:OUTPUT ACCEPT [0:0]
#-A OUTPUT -p tcp -m tcp --dport 80 -m owner --uid-owner brett -j TRACE
#COMMIT


# Allow masquerading for everything not caught by the filter table rules.
*nat
:POSTROUTING ACCEPT [0:0]
-A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE
COMMIT


# filter rules -----------------------------------------------------------------

*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -i lo -j ACCEPT
-A OUTPUT -m owner --uid-owner root -j ACCEPT
-A OUTPUT -m owner --uid-owner sentinel -j ACCEPT
-A OUTPUT -m owner --uid-owner proxy -j ACCEPT
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 2200 -j ACCEPT
-A INPUT -i eth0 -j DROP
-A OUTPUT -p tcp -m owner --uid-owner proxy -j ACCEPT
-A FORWARD -i eth1 -p tcp -m tcp --dport 80 -j DROP
-A OUTPUT -p tcp -m tcp --dport 80 -j DROP
-A FORWARD -i eth1 -p tcp -m tcp --dport 443 -j DROP
-A OUTPUT -p tcp -m tcp --dport 443 -j DROP
COMMIT
